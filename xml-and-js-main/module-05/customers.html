<!DOCTYPE html>
<html lang="en">
    <body>
        <ol id="customer"></ol>
        <script>
            const xhttp = new XMLHttpRequest();
            xhttp.onreadystatechange = function () 
            {
                if (this.readyState == 4 && this.status == 200) 
                {
                    displayData(this.responseXML);
                }
            };

            xhttp.open("GET", "..//customers.xml", true);
            xhttp.send();

            function stringToNode(html) 
            {
                const template = document.createElement(`template`);
                html = html.trim();
                template.innerHTML = html;
                return template.content.firstChild;
            }

            function displayData(xmlDoc) 
            {
                const listElement = document.getElementById(`customers`);
                const userNodes = xmlDoc.getElementsByTagName(`customer`);

                for (let index = 0; index < userNodes.length; index++) 
                {
                    const userNode = userNodes[index];
                    console.log(userNode.getElementsByTagName(`order`))
                    const listItem = stringToNode(`<li>
                    <h2>${
                    userNode.getElementsByTagName(`name`)[0].attributes[0].nodeValue
                    } 
                    ${
                    userNode.getElementsByTagName(`name`)[0].childNodes[0].nodeValue
                    }</h2>

                    <p> Address: ${userNode.getElementsByTagName(`address`)[0].childNodes[0].nodeValue} </p>
                    <p> phoneNumber: ${userNode.getElementsByTagName(`phone`)[0].childNodes[0].nodeValue} </p>
                    <p>${`Email: ${
                        userNode.getElementsByTagName(`email`)[0] ? userNode.getElementsByTagName(`email`)[0].childNodes[0].nodeValue : ""
                    }`}</p>
                    
                    <ol id="${userNode.getAttribute('custID')}"> <h4> Order Items </h4> </ol> 
                    </li>`);

                    listElement.appendChild(listItem);
                }
                displayOrderData(xmlDoc)
            }
      
            function displayOrderData(xmlDoc) 
            {
                const orderNodes = xmlDoc.getElementsByTagName(`order`);
                for (let index = 0; index < orderNodes.length; index++) 
                {
                    const orderNode = orderNodes[index];
                    console.log(orderNode.getElementsByTagName(`items`)[0].children[0].getElementsByTagName('itemPrice')[0].childNodes[0].nodeValue)
                    const orderElement = document.getElementById(`${ orderNode.getAttribute('orderBy')}`);
                    const orderItems = stringToNode(`
                    <li>
                    <p> OrderDate: ${orderNode.getElementsByTagName(`orderDate`)[0].childNodes[0].nodeValue} </p>
                    <p> itemPrice: ${orderNode.getElementsByTagName(`items`)[0].children[0].getElementsByTagName('itemPrice')[0].childNodes[0].nodeValue} </p>
                    <p> itemQty: ${orderNode.getElementsByTagName(`items`)[0].children[0].getElementsByTagName('itemQty')[0].childNodes[0].nodeValue} </p>
                    </li>`);
                    orderElement.appendChild(orderItems);
                }
            }
        </script>
    </body>
</html>